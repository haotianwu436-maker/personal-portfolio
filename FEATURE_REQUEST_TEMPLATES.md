# 功能需求模板指南

本文档提供了常见功能需求的模板。你可以直接复制相应的模板，填入具体信息，然后发送给Cursor。Cursor会根据模板自动理解需求并实现。

## 📋 模板使用说明

每个模板包含以下部分：

- **功能描述**：清晰说明要实现什么
- **技术要求**：涉及的技术栈和文件
- **实现步骤**：Cursor需要做的事情
- **测试要求**：需要编写的测试
- **验收标准**：功能完成的标志

## 🎯 模板列表

本文档包含以下模板：

1. **新页面模板** - 添加新的React页面
2. **API端点模板** - 添加新的tRPC API端点
3. **数据库表模板** - 添加新的数据库表
4. **UI组件模板** - 创建可复用的UI组件
5. **功能集成模板** - 复杂功能（涉及多个部分）

---

## 模板1：新页面

### 使用场景
添加新的页面，如"关于我"页面、"作品集"页面等。

### 模板内容

```
【功能需求】新页面：[页面名称]

【功能描述】
[简要描述页面的目的和功能]

【页面信息】
- 页面名称：[例如：About Me]
- 路由路径：[例如：/about]
- 文件位置：client/src/pages/[PageName].tsx
- 导航菜单：[是/否，如果是，在哪里添加]

【页面内容】
[描述页面应该包含的主要内容和布局]

【设计要求】
- 风格：遵循Quiet Narrative设计（米色背景、深灰色文字、森林绿强调色）
- 响应式：支持移动设备
- 动画：[可选的framer-motion动画描述]

【集成要求】
- 是否需要添加到导航栏：[是/否]
- 是否需要新的API端点：[是/否，如果是列出]
- 是否需要新的数据库表：[是/否，如果是列出]

【验收标准】
- [ ] 页面在 /[路由] 可以访问
- [ ] 页面响应式设计正常
- [ ] 所有文本清晰可读
- [ ] 所有测试通过
- [ ] 网站发布后页面正常显示
```

### 使用示例

```
【功能需求】新页面：关于我

【功能描述】
添加一个"关于我"页面，展示个人背景、技能、经历等信息。

【页面信息】
- 页面名称：About
- 路由路径：/about
- 文件位置：client/src/pages/About.tsx
- 导航菜单：是，在主导航栏中添加

【页面内容】
- 个人简介（200字）
- 核心技能列表（5-7项）
- 工作经历时间线
- 教育背景
- 联系方式按钮

【设计要求】
- 风格：遵循Quiet Narrative设计
- 响应式：支持移动设备
- 动画：使用framer-motion实现滚动时的淡入动画

【集成要求】
- 是否需要添加到导航栏：是
- 是否需要新的API端点：否
- 是否需要新的数据库表：否

【验收标准】
- [ ] 页面在 /about 可以访问
- [ ] 页面响应式设计正常
- [ ] 所有文本清晰可读
- [ ] 所有测试通过
- [ ] 网站发布后页面正常显示
```

---

## 模板2：API端点

### 使用场景
添加新的后端API端点，如获取数据、保存数据等。

### 模板内容

```
【功能需求】API端点：[端点名称]

【功能描述】
[清晰描述API的功能]

【API信息】
- 端点名称：[例如：newsletter.subscribe]
- 请求方法：[query/mutation]
- 输入参数：
  * [参数名]：[类型]，[描述]
  * [参数名]：[类型]，[描述]
- 返回值：
  * [字段名]：[类型]，[描述]
- 错误处理：[可能的错误和处理方式]

【数据库操作】
- 是否需要新表：[是/否]
- 是否需要新的查询函数：[是/否]
- 涉及的表：[列出相关表名]

【权限要求】
- 是否需要认证：[是/否]
- 权限检查：[描述权限规则]

【实现步骤】
1. [第一步]
2. [第二步]
3. [第三步]

【测试要求】
- [ ] 编写单元测试
- [ ] 测试正常情况
- [ ] 测试错误情况
- [ ] 测试权限检查

【验收标准】
- [ ] API端点可以正确调用
- [ ] 返回值格式正确
- [ ] 所有测试通过
- [ ] 错误处理正确
```

### 使用示例

```
【功能需求】API端点：订阅邮件列表

【功能描述】
用户可以通过输入邮箱地址订阅邮件列表。API会验证邮箱格式，保存到数据库，并返回成功或失败的消息。

【API信息】
- 端点名称：newsletter.subscribe
- 请求方法：mutation
- 输入参数：
  * email：string，用户邮箱地址
- 返回值：
  * success：boolean，是否订阅成功
  * message：string，返回消息
- 错误处理：
  * 邮箱格式错误：返回"Invalid email format"
  * 邮箱已存在：返回"Email already subscribed"
  * 数据库错误：返回"Subscription failed"

【数据库操作】
- 是否需要新表：是（newsletters表）
- 是否需要新的查询函数：是（subscribeNewsletter函数）
- 涉及的表：newsletters

【权限要求】
- 是否需要认证：否
- 权限检查：无

【实现步骤】
1. 在drizzle/schema.ts中创建newsletters表
2. 在server/db.ts中创建subscribeNewsletter查询函数
3. 在server/routers.ts中添加newsletter.subscribe端点
4. 编写单元测试

【测试要求】
- [ ] 编写单元测试
- [ ] 测试正常情况（有效邮箱）
- [ ] 测试错误情况（无效邮箱、重复邮箱）
- [ ] 测试权限检查

【验收标准】
- [ ] API端点可以正确调用
- [ ] 返回值格式正确
- [ ] 所有测试通过
- [ ] 错误处理正确
```

---

## 模板3：数据库表

### 使用场景
添加新的数据库表来存储数据。

### 模板内容

```
【功能需求】数据库表：[表名]

【表信息】
- 表名：[例如：newsletters]
- 用途：[描述表的用途]

【字段定义】
| 字段名 | 类型 | 约束 | 描述 |
|-------|------|------|------|
| id | text | PRIMARY KEY | [描述] |
| [字段名] | [类型] | [约束] | [描述] |
| [字段名] | [类型] | [约束] | [描述] |

【索引和关系】
- 主键：[字段名]
- 唯一约束：[字段名]
- 外键关系：[如果有]
- 索引：[如果需要]

【数据库操作函数】
需要在server/db.ts中创建以下函数：
- [函数名]：[描述]
- [函数名]：[描述]

【迁移步骤】
1. 在drizzle/schema.ts中定义表
2. 运行 pnpm db:push 应用迁移
3. 验证表已创建

【验收标准】
- [ ] 表已在数据库中创建
- [ ] 所有字段类型正确
- [ ] 约束正确应用
- [ ] 可以正确插入和查询数据
```

### 使用示例

```
【功能需求】数据库表：邮件订阅

【表信息】
- 表名：newsletters
- 用途：存储邮件列表订阅者的邮箱地址

【字段定义】
| 字段名 | 类型 | 约束 | 描述 |
|-------|------|------|------|
| id | text | PRIMARY KEY | 唯一标识符 |
| email | text | UNIQUE NOT NULL | 订阅者邮箱 |
| createdAt | timestamp | DEFAULT NOW() | 订阅时间 |

【索引和关系】
- 主键：id
- 唯一约束：email
- 外键关系：无
- 索引：email（用于快速查询）

【数据库操作函数】
需要在server/db.ts中创建以下函数：
- subscribeNewsletter(email: string)：添加新订阅者
- getNewsletterSubscriber(email: string)：查询订阅者
- deleteNewsletterSubscriber(id: string)：删除订阅者

【迁移步骤】
1. 在drizzle/schema.ts中定义表
2. 运行 pnpm db:push 应用迁移
3. 验证表已创建

【验收标准】
- [ ] 表已在数据库中创建
- [ ] 所有字段类型正确
- [ ] 约束正确应用
- [ ] 可以正确插入和查询数据
```

---

## 模板4：UI组件

### 使用场景
创建可复用的UI组件，如按钮、卡片、表单等。

### 模板内容

```
【功能需求】UI组件：[组件名]

【组件信息】
- 组件名：[例如：NewsletterForm]
- 文件位置：client/src/components/[ComponentName].tsx
- 用途：[描述组件的用途]

【组件属性】
| 属性名 | 类型 | 必需 | 默认值 | 描述 |
|-------|------|------|--------|------|
| [属性名] | [类型] | [是/否] | [值] | [描述] |

【组件功能】
- [功能1]
- [功能2]
- [功能3]

【设计要求】
- 风格：[描述设计风格]
- 颜色：[使用的颜色]
- 尺寸：[支持的尺寸]
- 状态：[支持的状态，如loading、disabled等]

【依赖项】
- UI库：[使用的UI库]
- 图标库：[使用的图标库]
- 其他库：[其他依赖]

【验收标准】
- [ ] 组件可以正确渲染
- [ ] 所有属性正确工作
- [ ] 响应式设计正常
- [ ] 所有测试通过
```

### 使用示例

```
【功能需求】UI组件：邮件订阅表单

【组件信息】
- 组件名：NewsletterForm
- 文件位置：client/src/components/NewsletterForm.tsx
- 用途：显示邮件订阅表单，允许用户输入邮箱并订阅

【组件属性】
| 属性名 | 类型 | 必需 | 默认值 | 描述 |
|-------|------|------|--------|------|
| onSuccess | function | 否 | - | 订阅成功时的回调函数 |
| onError | function | 否 | - | 订阅失败时的回调函数 |
| placeholder | string | 否 | "Enter your email" | 输入框占位符 |

【组件功能】
- 显示邮箱输入框
- 显示订阅按钮
- 验证邮箱格式
- 调用API提交订阅
- 显示成功或失败提示

【设计要求】
- 风格：遵循Quiet Narrative设计
- 颜色：背景米色，文字深灰色，按钮森林绿
- 尺寸：响应式，在移动设备和桌面上都能正常显示
- 状态：支持loading状态（提交中）、disabled状态（已订阅）

【依赖项】
- UI库：shadcn/ui
- 图标库：lucide-react
- 其他库：sonner（用于显示提示）

【验收标准】
- [ ] 组件可以正确渲染
- [ ] 所有属性正确工作
- [ ] 响应式设计正常
- [ ] 所有测试通过
```

---

## 模板5：功能集成（复杂功能）

### 使用场景
实现涉及多个部分的复杂功能，如完整的用户认证系统、评论系统等。

### 模板内容

```
【功能需求】功能集成：[功能名称]

【功能概述】
[详细描述整个功能的目的和工作流程]

【功能组成】
1. **前端部分**
   - 页面：[列出涉及的页面]
   - 组件：[列出涉及的组件]
   - Hooks：[列出涉及的hooks]

2. **后端部分**
   - API端点：[列出涉及的API]
   - 数据库表：[列出涉及的表]
   - 查询函数：[列出涉及的函数]

3. **数据库部分**
   - 新表：[列出新表]
   - 修改表：[列出修改的表]

【工作流程】
[用流程图或步骤描述整个功能的工作流程]

【实现步骤】
1. [步骤1]
2. [步骤2]
3. [步骤3]
...

【测试要求】
- [ ] 单元测试
- [ ] 集成测试
- [ ] 端到端测试

【验收标准】
- [ ] 所有功能正常工作
- [ ] 所有测试通过
- [ ] 网站发布后功能正常显示
```

### 使用示例

```
【功能需求】功能集成：文章评论系统

【功能概述】
实现一个完整的文章评论系统，允许访客在文章下方发表评论。功能包括：发表评论、显示评论列表、管理员回复评论、删除评论等。

【功能组成】
1. **前端部分**
   - 页面：ArticleDetail.tsx（添加评论部分）
   - 组件：CommentForm.tsx、CommentList.tsx、CommentItem.tsx
   - Hooks：useComments.ts

2. **后端部分**
   - API端点：comments.create、comments.list、comments.delete、comments.reply
   - 数据库表：comments、commentReplies
   - 查询函数：createComment、getCommentsByArticle、deleteComment等

3. **数据库部分**
   - 新表：comments（存储评论）、commentReplies（存储回复）
   - 修改表：articles（添加commentCount字段）

【工作流程】
1. 用户在文章下方看到评论表单
2. 用户输入评论内容并提交
3. 评论保存到数据库
4. 评论列表实时更新
5. 管理员可以在后台回复评论
6. 用户可以看到评论和回复

【实现步骤】
1. 创建comments和commentReplies表
2. 创建评论API端点
3. 创建CommentForm和CommentList组件
4. 在ArticleDetail页面集成评论部分
5. 编写单元测试
6. 编写集成测试

【测试要求】
- [ ] 单元测试（每个组件和API）
- [ ] 集成测试（评论提交和显示流程）
- [ ] 端到端测试（完整的用户交互）

【验收标准】
- [ ] 用户可以发表评论
- [ ] 评论正确显示在文章下方
- [ ] 管理员可以回复评论
- [ ] 用户可以删除自己的评论
- [ ] 所有测试通过
- [ ] 网站发布后功能正常显示
```

---

## 🎯 如何使用这些模板

### 步骤1：选择合适的模板
根据你的需求，选择最合适的模板。

### 步骤2：填入具体信息
复制模板内容，填入你的具体需求信息。

### 步骤3：发送给Cursor
将填好的模板发送给Cursor。

### 步骤4：Cursor自动实现
Cursor会根据模板自动理解需求并实现功能。

---

## 💡 模板编写建议

1. **尽可能详细**：提供的信息越详细，Cursor理解的就越准确
2. **使用示例**：如果可能，提供数据示例或UI示例
3. **明确验收标准**：清楚地说明功能完成的标志
4. **列出所有文件**：说明涉及的所有文件和修改
5. **考虑测试**：提前考虑需要编写的测试

---

## 📚 相关文档

- **CURSOR_AUTO_DEPLOY.md** - 自动化部署流程
- **CURSOR_QUICK_START.md** - 快速参考指南
- **CURSOR_WORKFLOW.md** - 项目架构和规范

---

**现在你已经有了完整的模板库，可以快速向Cursor描述需求了！** 🚀
